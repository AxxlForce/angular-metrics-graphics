/* Compiled 2015-04-16 10:04:00 */

"use strict";if(!angular.merge){var slice=[].slice,setHashKey=function(a,b){b?a.$$hashKey=b:delete a.$$hashKey},baseExtend=function(a,b,c){for(var d=a.$$hashKey,e=0,f=b.length;f>e;++e){var g=b[e];if(angular.isObject(g)||angular.isFunction(g))for(var h=Object.keys(g),i=0,j=h.length;j>i;i++){var k=h[i],l=g[k];c&&angular.isObject(l)?(angular.isObject(a[k])||(a[k]=angular.isArray(l)?[]:{}),baseExtend(a[k],[l],!0)):a[k]=l}}return setHashKey(a,d),a};angular.merge=function(a){return baseExtend(a,slice.call(arguments,1),!0)}}angular.module("metricsgraphics",["rt.debounce"]).factory("linkService",function(){var a={},b={},c={};return{set:function(d,e){var f=a[d]=b[d],g=b[d]=e,h=c[d];h&&angular.forEach(h,function(a){a(g,f)})},get:function(a){return b[a]},on:function(a,b){if(!angular.isFunction(b))throw new Error("Only functions allowed as callback argument");var d=c[a];d||(d=[],c[a]=d),d.push(b)},off:function(a,b){var d=c[a];if(d)for(var e=0;e<d.length;e++)d[e]===b&&(d.splice(e,1),e--)}}}).directive("chart",["$window","$timeout","debounce","linkService",function(a,b,c,d){return{link:function(c,e,f){function g(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c="",d=0;a>d;d++){var e=Math.floor(Math.random()*b.length);c+=b.substring(e,e+1)}return c}function h(a){if(!angular.isElement(a))throw new Error("Only DOM/JQuery allowed.");var b=a.clientWidth,c=getComputedStyle(a,null),d=c.getPropertyValue("padding-right");b-=parseInt(d);var e=c.getPropertyValue("padding-right");return b-=parseInt(e)}function i(a,b){var c=b.x+b.width/2,d=b.y,e=d+b.height,f=a.append("g").attr("class","focus-line"),g=f.append("line").attr("x1",c).attr("x2",c).attr("y1",d).attr("y2",e).style("opacity",0);return g}function j(a){var b=a.append("circle").attr("class","focus-circle").attr("r",3).style("pointer-events","none").style("stroke-width","1px").style("opacity",0);return b}function k(a){var b=a.append("span").attr("class","focus-txt");return b}function l(a){var b=a.append("div").attr("class","focus-tooltip").style("position","absolute").style("opacity",0);return b}function m(a){return a.append("rect").attr("x",c.graphBoundingBox.x).attr("y",c.graphBoundingBox.y).attr("width",c.graphBoundingBox.width).attr("height",c.graphBoundingBox.height).style("fill","none").style("stroke","none").style("pointer-events","all")}function n(a,b,c,d){if(null!==a||null!==b){if(null===a&&null!==b)return t.style("opacity",1),u.style("opacity",1),void v.style("opacity",1);if(null!==a&&null===b)return t.style("opacity",0),u.style("opacity",0),void v.style("opacity",0);t.attr("x1",b),t.attr("x2",b);var e=d.scales.X.invert(b),f=d3.bisector(function(a){return a[d.x_accessor]}).right,g=f(c,e,1),h=c[g-1],i=c[g],j=e-h[d.x_accessor]>i[d.x_accessor]-e?i:h,k=j[d.y_accessor],l=d.scales.Y(k);u.attr("cx",b),u.attr("cy",l),w.html(k),v.style("left",r[0][0].offsetLeft+b+10+"px").style("top",r[0][0].offsetTop+10+"px")}}function o(a,b){var e=function(c,e){d.get("target")!==y.target&&n(e,c,a,b)};return d.on("x",e),c.$on("$destroy",function(){d.off("x",e)}),e}function p(a,b){if(a&&a.length>0){angular.isDefined(b.width)||(y.width=h(x[0])),angular.merge(y,b),y.data&&(y.data=null);var f=angular.copy(y);if(f.data=a,!y.linked&&q&&(d.off(q),q=null),y.linked&&!q&&(q=o(a,f)),MG.data_graphic(f),r)return;if(r=d3.select(e[0]).select("svg"),c.graphBoundingBox=d3.select(e[0]).select("svg .mg-clip-path rect")[0][0].getBBox(),z){s=r.append("g"),t=i(s,c.graphBoundingBox),u=j(s),v=l(d3.select(e[0])),w=k(v);var g=m(s);g.on("mouseover",function(){var b=d3.mouse(this)[0];n(null,b,a,f),y.linked&&(d.set("target",y.target),d.set("x",b))}).on("mouseout",function(b){var c=d3.mouse(this)[0];n(c,null,a,f),y.linked&&(d.set("target",null),d.set("x",null))}).on("mousemove",function(b){var c=d3.mouse(this)[0];n(c,c,a,f),y.linked&&d.set("x",c)}),r.on("mouseover",function(){this.appendChild(s.node())})}}}var q,r,s,t,u,v,w,x=e.parent(),y={},z=f.hasOwnProperty("hoverline");e[0].id=e[0].id?e[0].id:"mg-chart-"+g(5),y.target="#"+e[0].id,angular.merge(y,c.options),c.$watchCollection("data",function(a){p(a,y)}),c.$watch("options",function(a){a.target&&delete a.target,p(c.data,a)},!0),angular.element(a).on("resize",function(){delete y.width,p(c.data,y)}),b(function(){p(c.data,y)})},restrict:"E",scope:{data:"=",options:"=",graphBoundingBox:"=?"}}}]);
//# sourceMappingURL=angular-metrics-graphics.min.map
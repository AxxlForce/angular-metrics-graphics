/* Compiled 2015-04-20 04:04:15 */

"use strict";if(!angular.merge){var slice=[].slice,setHashKey=function(a,b){b?a.$$hashKey=b:delete a.$$hashKey},baseExtend=function(a,b,c){for(var d=a.$$hashKey,e=0,f=b.length;f>e;++e){var g=b[e];if(angular.isObject(g)||angular.isFunction(g))for(var h=Object.keys(g),i=0,j=h.length;j>i;i++){var k=h[i],l=g[k];c&&angular.isObject(l)?(angular.isObject(a[k])||(a[k]=angular.isArray(l)?[]:{}),baseExtend(a[k],[l],!0)):a[k]=l}}return setHashKey(a,d),a};angular.merge=function(a){return baseExtend(a,slice.call(arguments,1),!0)}}angular.module("metricsgraphics",["rt.debounce"]).factory("linkService",function(){var a={},b={},c={};return{set:function(d,e){var f=a[d]=b[d],g=b[d]=e,h=c[d];h&&angular.forEach(h,function(a){a(g,f)})},get:function(a){return b[a]},on:function(a,b){if(!angular.isFunction(b))throw new Error("Only functions allowed as callback argument");var d=c[a];d||(d=[],c[a]=d),d.push(b)},off:function(a,b){var d=c[a];if(d)for(var e=0;e<d.length;e++)d[e]===b&&(d.splice(e,1),e--)}}}).directive("chart",["$window","$timeout","debounce","linkService",function(a,b,c,d){return{link:function(c,e,f){function g(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c="",d=0;a>d;d++){var e=Math.floor(Math.random()*b.length);c+=b.substring(e,e+1)}return c}function h(a){if(!angular.isElement(a))throw new Error("Only DOM/JQuery allowed.");var b=a.clientWidth,c=getComputedStyle(a,null),d=c.getPropertyValue("padding-right");b-=parseInt(d);var e=c.getPropertyValue("padding-right");return b-=parseInt(e)}function i(a,b){var c=b.x+b.width/2,d=b.y,e=d+b.height,f=a.append("g").attr("class","focus-line"),g=f.append("line").attr("x1",c).attr("x2",c).attr("y1",d).attr("y2",e).style("opacity",0);return g}function j(a){var b=a.append("circle").attr("class","focus-circle").attr("r",3).style("pointer-events","none").style("stroke-width","1px").style("opacity",0);return b}function k(a){var b=a.append("span").attr("class","focus-txt");return b}function l(a){var b=a.append("div").attr("class","focus-tooltip").style("position","absolute").style("opacity",0);return b}function m(a){return a.append("rect").attr("x",c.graphBoundingBox.x).attr("y",c.graphBoundingBox.y).attr("width",c.graphBoundingBox.width).attr("height",c.graphBoundingBox.height).style("fill","none").style("stroke","none").style("pointer-events","all")}function n(a,b){if(null!==a||null!==b){if(null===a&&null!==b)return t.style("opacity",1),u.style("opacity",1),void v.style("opacity",1);if(null!==a&&null===b)return t.style("opacity",0),u.style("opacity",0),void v.style("opacity",0);t.attr("x1",b),t.attr("x2",b);var d=x.scales.X.invert(b),e=d3.bisector(function(a){return a[x.x_accessor]}).right,f=e(c.data,d,1),g=c.data[f-1],h=c.data[f],i=d-g[x.x_accessor]>h[x.x_accessor]-d?h:g,j=i[x.y_accessor],k=x.scales.Y(j);u.attr("cx",b),u.attr("cy",k),w.html(j),v.style("left",r[0][0].offsetLeft+b+10+"px").style("top",r[0][0].offsetTop+10+"px")}}function o(a,b){var e=function(c,e){d.get("target")!==z.target&&n(e,c,a,b)};return d.on("x",e),c.$on("$destroy",function(){d.off("x",e)}),e}function p(a,b){if(angular.isDefined(b.width)||(z.width=h(y[0])),angular.merge(z,b),a&&0!==a.length){if(z.data&&(z.data=null),x=angular.copy(z),x.data=a,!z.linked&&q&&(d.off(q),q=null),z.linked&&!q&&(q=o(a,x)),MG.data_graphic(x),!r&&(r=d3.select(e[0]).select("svg"),c.graphBoundingBox=d3.select(e[0]).select("svg .mg-clip-path rect")[0][0].getBBox(),A)){s=r.append("g"),t=i(s,c.graphBoundingBox),u=j(s),v=l(d3.select(e[0])),w=k(v);var f=m(s);f.on("mouseover",function(){var a=d3.mouse(this)[0];n(null,a),z.linked&&(d.set("target",z.target),d.set("x",a))}).on("mouseout",function(){var a=d3.mouse(this)[0];n(a,null),z.linked&&(d.set("target",null),d.set("x",null))}).on("mousemove",function(){var a=d3.mouse(this)[0];n(a,a),z.linked&&d.set("x",a)}),r.on("mouseover",function(){this.appendChild(s.node())})}}else if(z.missing_text){var g=angular.copy(z);g.chart_type="missing-data",MG.data_graphic(g)}}var q,r,s,t,u,v,w,x,y=e.parent(),z={},A=f.hasOwnProperty("hoverline");e[0].id=e[0].id?e[0].id:"mg-chart-"+g(5),z.target="#"+e[0].id,angular.merge(z,c.options),c.$watchCollection("data",function(a){p(a,z)}),c.$watch("options",function(a){a.target&&delete a.target,p(c.data,a)},!0),angular.element(a).on("resize",function(){delete z.width,p(c.data,z)}),b(function(){p(c.data,z)})},restrict:"E",scope:{data:"=",options:"=",graphBoundingBox:"=?"}}}]);
//# sourceMappingURL=angular-metrics-graphics.min.map